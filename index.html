<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KPI Rəy Forması – Addım-addım</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <!-- Step 1: Name Entry -->
    <section class="card step active" id="step1">
      <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="User Icon" class="icon" />
      <h2>Xoş gəlmisən 👋</h2>
      <p>Zəhmət olmasa ad və soyadınızı daxil edin</p>
      <input type="text" id="responder" placeholder="Məs: Elvin Məmmədov" required />
      <button onclick="startSurvey()">Davam et</button>
    </section>

    <!-- Dynamic Steps for Questions will be inserted here -->
    <div id="questionSteps"></div>

    <!-- Final Step: Submit -->
    <section class="card step" id="finalStep">
      <h2>Təşəkkür edirik!</h2>
      <p>Bütün suallara cavab verdiniz. Göndər düyməsinə klikləyərək rəyinizi tamamlayın.</p>
      <button onclick="submitAnswers()">Rəyi Göndər</button>
    </section>
  </div>

  <script>
    const responderInput = document.getElementById("responder");
    const questionStepsContainer = document.getElementById("questionSteps");
    const questions = [
      "Emosional Zəka", "Liderlik Bacarığı", "Kreativlik",
      "Danışıqlar Bacarığı", "Müştəri Yönümlülük", "Şəbəkələşmə",
      "Analitik Düşüncə", "Qərarvermə Bacarığı", "Etika və Dürüstlük",
      "İT Bacarığı", "Ünsiyyət Bacarığı", "Komanda İşi", "Vaxtın İdarə Edilməsi",
      "Problem Həll Etmə", "Öyrənməyə Açıq Olmaq", "Məsuliyyətlilik",
      "Elastiklik", "Detala Diqqət", "Motivasiya", "Stres İdarəçiliyi"
    ];

    let currentStep = 1;
    const answers = {};

    function startSurvey() {
      const name = responderInput.value.trim();
      if (!name) return alert("Adınızı daxil edin");

      document.getElementById("step1").classList.remove("active");

      questions.forEach((q, index) => {
        const step = document.createElement("section");
        step.className = "card question-step";
        if (index === 0) step.classList.add("active");

        step.innerHTML = `
          <div class="question">
            <h2>${index + 1}. ${q}</h2>
            <div class="slider-value">Seçim: <span id="val${index}">3</span></div>
            <input type="range" min="1" max="5" value="3" id="q${index}"
              oninput="document.getElementById('val${index}').textContent = this.value">
            <div class="scale"><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span></div>
            <textarea placeholder="Açıqlama (istəyə bağlı)" id="c${index}"></textarea>
            <button onclick="nextStep(${index})">Növbəti</button>
          </div>
        `;
        questionStepsContainer.appendChild(step);
      });
    }

    function nextStep(index) {
      const curr = document.getElementsByClassName("question-step")[index];
      curr.classList.remove("active");
      const next = document.getElementsByClassName("question-step")[index + 1];
      if (next) {
        next.classList.add("active");
      } else {
        document.getElementById("finalStep").classList.add("active");
      }
    }

    async function submitAnswers() {
      const name = responderInput.value.trim();
      const data = { responder: name };

      for (let i = 0; i < questions.length; i++) {
        data[`q${i+1}`] = document.getElementById(`q${i}`).value;
        data[`c${i+1}`] = document.getElementById(`c${i}`).value;
      }

      const response = await fetch('https://script.google.com/macros/s/AKfycbxWfsu6XCki3Ydhdr_oGPG13RKx0A2KJx-aFvqyV7vwDxiyjB2f0xBfDPxk3vML2Ku0eA/exec', {
        method: 'POST',
        body: JSON.stringify(data),
        headers: { 'Content-Type': 'application/json' }
      });

      alert("Rəy uğurla göndərildi!");
      location.reload();
    }
  </script>
</body>
</html>
