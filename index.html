<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <title>KPI Rəy Forması</title>
  <script>
    let responderName = "";

    function saveName() {
      responderName = document.getElementById("responder").value.trim();
      if (!responderName) {
        alert("Zəhmət olmasa adınızı daxil edin.");
        return;
      }
      document.getElementById("step1").style.display = "none";
      document.getElementById("step2").style.display = "block";
    }

    async function submitFeedback(event) {
      event.preventDefault();

      const department = document.getElementById("department").value;
      const rated = document.getElementById("rated").value.trim();
      if (!rated) {
        alert("Zəhmət olmasa rəy verdiyiniz əməkdaşın adını daxil edin.");
        return;
      }

      const data = {
        responder: responderName,
        department: department,
        rated: rated
      };

      for (let i = 1; i <= 20; i++) {
        data[`q${i}`] = document.getElementById(`q${i}`).value;
        data[`c${i}`] = document.getElementById(`c${i}`).value;
      }

      const response = await fetch('https://script.google.com/macros/s/AKfycbxWfsu6XCki3Ydhdr_oGPG13RKx0A2KJx-aFvqyV7vwDxiyjB2f0xBfDPxk3vML2Ku0eA/exec', {
        method: 'POST',
        body: JSON.stringify(data),
        headers: { 'Content-Type': 'application/json' }
      });

      const result = await response.text();
      alert(result);
      document.getElementById("feedbackForm").reset();
    }
  </script>
</head>
<body>
  <!-- Step 1: Responder Name -->
  <div id="step1">
    <h2>1. Ad Soyadınızı daxil edin</h2>
    <input type="text" id="responder" placeholder="Adınız və Soyadınız" required>
    <button onclick="saveName()">Davam et</button>
  </div>

  <!-- Step 2: Full Feedback Form -->
  <div id="step2" style="display:none">
    <form id="feedbackForm" onsubmit="submitFeedback(event)">
      <h2>2. Rəy Forması</h2>

      <label>Əməkdaş hansı şöbədə çalışır?</label><br>
      <select id="department" required>
        <option value="">-- Şöbə seçin --</option>
        <option value="Satış">Satış</option>
        <option value="Təchizat">Təchizat</option>
        <option value="İnsan Resursları">İnsan Resursları</option>
        <option value="Maliyyə">Maliyyə</option>
        <option value="İT">İT</option>
        <!-- Digər şöbələri əlavə edə bilərsiniz -->
      </select><br><br>

      <label>Rəy bildirdiyiniz əməkdaşın adı və soyadı:</label><br>
      <input type="text" id="rated" required><br><br>

      <!-- Questions 1–20 -->
      <div>
        <h3>3. Suallar (1–5 arasında qiymətləndirin və səbəbi qeyd edin)</h3>

        <!-- Template question format -->
        <!-- Repeat block below 20 times with different texts -->

        <script>
          const questions = [
            "Emosional Zəka (EQ)",
            "Liderlik Bacarıqları",
            "Kreativlik və İnnovasiya",
            "Danışıqlar Bacarığı",
            "Müştəri Yönümlülük",
            "Şəbəkələşmə (Networking)",
            "Analitik Düşüncə",
            "Qərarvermə Bacarığı",
            "Etika və Peşəkar Dürüstlük",
            "İnformasiya Texnologiyalarına Yatkınlıq",
            "Ünsiyyət Bacarıqları",
            "Komanda İşi",
            "Vaxtın İdarə Edilməsi",
            "Problem Həll Etmə",
            "Öyrənməyə Açıq Olmaq",
            "Məsuliyyət Hissi",
            "Elastiklik və Uyum Bacarığı",
            "Diqqət və Detala Yönəklik",
            "Motivasiya və Çalışqanlıq",
            "Stres İdarəçiliyi"
          ];

          window.onload = () => {
            const container = document.getElementById("questions");
            questions.forEach((q, i) => {
              const n = i + 1;
              container.innerHTML += `
                <label>${n}. ${q} (1-5):</label><br>
                <input type="number" id="q${n}" min="1" max="5" required><br>
                <label>Səbəb:</label><br>
                <textarea id="c${n}" rows="2" cols="50" placeholder="Əgər istəyirsinizsə, səbəbi yazın..."></textarea><br><br>
              `;
            });
          };
        </script>

        <div id="questions"></div>

      </div>

      <button type="submit">Rəyi göndər</button>
    </form>
  </div>
</body>
</html>
